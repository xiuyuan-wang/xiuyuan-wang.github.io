(window.webpackJsonp=window.webpackJsonp||[]).push([[109],{374:function(e,s,n){"use strict";n.r(s);var a=n(14),t=Object(a.a)({},(function(){var e=this,s=e._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[s("p",[e._v("在学习源码之前，我们首先需要做的事情是，确保版本的稳定性。"),s("br"),e._v("\n因为代码是不断变化的，"),s("br"),e._v("\n包括Node.js的版本，webpack的版本，各方依赖的版本。")]),e._v(" "),s("h3",{attrs:{id:"_1-使用nvm管理node-js版本"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-使用nvm管理node-js版本"}},[e._v("#")]),e._v(" 1. 使用nvm管理Node.js版本")]),e._v(" "),s("p",[e._v("我们先来看Node.js的版本问题。")]),e._v(" "),s("p",[e._v("nvm 是 Node Version Manager 命令行工具，"),s("br"),e._v("\n安装方式可以参考github仓库。")]),e._v(" "),s("h4",{attrs:{id:"_1-1-删除已安装的node-js"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-1-删除已安装的node-js"}},[e._v("#")]),e._v(" 1.1 删除已安装的Node.js")]),e._v(" "),s("p",[e._v("命令行中贴入这些bash命令即可，")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("#!/bin/bash\nlsbom -f -l -s -pf /var/db/receipts/org.nodejs.pkg.bom \\\n| while read i; do\n  sudo rm /usr/local/${i}\ndone\nsudo rm -rf /usr/local/lib/node \\\n     /usr/local/lib/node_modules \\\n     /var/db/receipts/org.nodejs.*\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br")])]),s("h4",{attrs:{id:"_1-2-安装nvm-v0-33-11"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-2-安装nvm-v0-33-11"}},[e._v("#")]),e._v(" 1.2 安装nvm（v0.33.11）")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("$ curl -o- https://raw.githubusercontent.com/creationix/nvm/v0.33.11/install.sh | bash\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("安装后查看下nvm的版本，")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("$ nvm --version\n0.33.11\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("h4",{attrs:{id:"_1-3-使用nvm"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-3-使用nvm"}},[e._v("#")]),e._v(" 1.3 使用nvm")]),e._v(" "),s("p",[e._v("（1）安装最新的LTS版本")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("$ nvm intall --lts\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("p",[e._v("（2）使用指定的Node.js版本")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("$ nvm use 8.12.0\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h4",{attrs:{id:"_1-4-检查下node-js的版本"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-4-检查下node-js的版本"}},[e._v("#")]),e._v(" 1.4 检查下Node.js的版本")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("$ node --version\nv8.12.0\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br")])]),s("h3",{attrs:{id:"_2-新建一个webpack最简项目"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-新建一个webpack最简项目"}},[e._v("#")]),e._v(" 2. 新建一个webpack最简项目")]),e._v(" "),s("p",[e._v("由于通常的webpack项目，都是通过命令行调用 "),s("code",[e._v("webpack")]),e._v(" 运行的，"),s("br"),e._v("\n其原理一开始我也不知道，所以我们不如就从头开始吧。")]),e._v(" "),s("p",[e._v("我要先把一个能运行的最简webpack项目搭建起来才行。"),s("br"),e._v("\n以下我们新建了一个debug-webpack文件夹，然后配置webpack.config.js文件，"),s("br"),e._v("\n编写源码，然后再调用 webpack 命令行工具进行打包。")]),e._v(" "),s("h4",{attrs:{id:"_2-1-新建debug-webpack文件夹-并初始化"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-1-新建debug-webpack文件夹-并初始化"}},[e._v("#")]),e._v(" 2.1 新建debug-webpack文件夹，并初始化")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("$ mkdir ~/Test/debug-webpack \n$ cd ~/Test/debug-webpack \n$ npm init -f\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br")])]),s("h4",{attrs:{id:"_2-2-添加webpack-config-js和src-index-js"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-2-添加webpack-config-js和src-index-js"}},[e._v("#")]),e._v(" 2.2 添加webpack.config.js和src/index.js")]),e._v(" "),s("p",[e._v("（1）webpack.config.js")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("const path = require('path');\n\nmodule.exports = {\n    entry: {\n        index: path.resolve(__dirname, 'src/index.js'),\n    },\n    output: {\n        path: path.resolve(__dirname, 'dist/'),\n    },\n    module: {\n        rules: [\n            { test: /.js$/, use: { loader: 'babel-loader', query: { presets: ['@babel/preset-env'] } } },\n        ]\n    },\n};\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br"),s("span",{staticClass:"line-number"},[e._v("13")]),s("br"),s("span",{staticClass:"line-number"},[e._v("14")]),s("br"),s("span",{staticClass:"line-number"},[e._v("15")]),s("br")])]),s("p",[e._v("这里我们解释一下，"),s("br"),e._v(" "),s("code",[e._v("entry")]),e._v(" 指定了入口文件，webpack会从这里开始进行构建。"),s("br"),e._v(" "),s("code",[e._v("output")]),e._v(" 指定了目标文件的输出地址，"),s("br"),e._v(" "),s("code",[e._v("module.rules")]),e._v(" 制定了webpack载入文件的方式，示例中指明对于 "),s("code",[e._v(".js")]),e._v(" 文件，我们采用"),s("code",[e._v("babel-loader")]),e._v(" 进行加载。")]),e._v(" "),s("p",[e._v("这里体现了webpack的一个强大之处，"),s("br"),e._v("\n我们可以为各种具有不同后缀名的文件，指定不同的loader进行加载，"),s("br"),e._v("\n用户可以写自己的loader。")]),e._v(" "),s("p",[e._v("entry，output，loader相关的概念，可以查阅官方文档："),s("a",{attrs:{href:"https://webpack.js.org/concepts/#entry",target:"_blank",rel:"noopener noreferrer"}},[e._v("https://webpack.js.org/concepts/#entry"),s("OutboundLink")],1),s("br"),e._v("\n​​"),s("br"),e._v("\n（2）src/index.js")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("alert();\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("h4",{attrs:{id:"_2-3-安装依赖"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-3-安装依赖"}},[e._v("#")]),e._v(" 2.3 安装依赖")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("$ npm i -D \\\nwebpack@4.20.2 \\\nwebpack-cli@3.1.2 \\\nbabel-loader@8.0.4 \\\n@babel/core@7.1.2 \\\n@babel/preset-env@7.1.0\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br")])]),s("p",[e._v("各依赖版本号，")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('"devDependencies": {\n    "@babel/core": "^7.1.2",\n    "@babel/preset-env": "^7.1.0",\n    "babel-loader": "^8.0.4",\n    "webpack": "^4.20.2",\n    "webpack-cli": "^3.1.2"\n}\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br")])]),s("h4",{attrs:{id:"_2-4-npm-scripts"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-4-npm-scripts"}},[e._v("#")]),e._v(" 2.4 npm scripts")]),e._v(" "),s("p",[e._v("配置package.json中的"),s("code",[e._v("scripts")]),e._v("字段，")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('{\n    ...,\n    "scripts:": {\n        ...,\n        "build": "webpack"\n    }\n    ...,\n}\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br")])]),s("p",[e._v("这样我们就可以通过"),s("code",[e._v("npm run build")]),e._v("来调用"),s("code",[e._v("node_modules/.bin/webpack")]),e._v("了。")]),e._v(" "),s("p",[e._v("这是因为"),s("code",[e._v("npm run")]),e._v("会自动添加"),s("code",[e._v("node_module/.bin")]),e._v(" 到当前命令所用的"),s("code",[e._v("PATH")]),e._v("变量中。"),s("br"),e._v("\n这一点我们可以参考"),s("a",{attrs:{href:"https://docs.npmjs.com/cli/run-script#description",target:"_blank",rel:"noopener noreferrer"}},[e._v("npm-run-script"),s("OutboundLink")],1),e._v("文档。")]),e._v(" "),s("h4",{attrs:{id:"_2-5-运行webpack"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-5-运行webpack"}},[e._v("#")]),e._v(" 2.5 运行webpack")]),e._v(" "),s("p",[e._v("我们在debug-webpack根目录下，执行以下命令，")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v("$ npm run build\n\n> debug-webpack@1.0.0 build ~/Test/debug-webpack\n> webpack\n\nHash: 2e91628041d9a877f709\nVersion: webpack 4.20.2\nTime: 639ms\nBuilt at: 2018-10-09 09:25:24\n   Asset       Size  Chunks             Chunk Names\nindex.js  937 bytes       0  [emitted]  index\nEntrypoint index = index.js\n[0] ./src/index.js 8 bytes {0} [built]\n")])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br"),s("span",{staticClass:"line-number"},[e._v("2")]),s("br"),s("span",{staticClass:"line-number"},[e._v("3")]),s("br"),s("span",{staticClass:"line-number"},[e._v("4")]),s("br"),s("span",{staticClass:"line-number"},[e._v("5")]),s("br"),s("span",{staticClass:"line-number"},[e._v("6")]),s("br"),s("span",{staticClass:"line-number"},[e._v("7")]),s("br"),s("span",{staticClass:"line-number"},[e._v("8")]),s("br"),s("span",{staticClass:"line-number"},[e._v("9")]),s("br"),s("span",{staticClass:"line-number"},[e._v("10")]),s("br"),s("span",{staticClass:"line-number"},[e._v("11")]),s("br"),s("span",{staticClass:"line-number"},[e._v("12")]),s("br"),s("span",{staticClass:"line-number"},[e._v("13")]),s("br")])]),s("h4",{attrs:{id:"_2-6-编译结果"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-6-编译结果"}},[e._v("#")]),e._v(" 2.6 编译结果")]),e._v(" "),s("p",[e._v("我们打开目标文件，./dist/index.js")]),e._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[e._v('!function(e){var t={};function r(n){if(t[n])return t[n].exports;var o=t[n]={i:n,l:!1,exports:{}};return e[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)r.d(n,o,function(t){return e[t]}.bind(null,o));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=0)}([function(e,t){alert()}]);\n')])]),e._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[e._v("1")]),s("br")])]),s("hr"),e._v(" "),s("h3",{attrs:{id:"参考"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[e._v("#")]),e._v(" 参考")]),e._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/creationix/nvm",target:"_blank",rel:"noopener noreferrer"}},[e._v("github: nvm"),s("OutboundLink")],1),s("br"),e._v(" "),s("a",{attrs:{href:"https://github.com/jesseyu/uninstallNodejs",target:"_blank",rel:"noopener noreferrer"}},[e._v("github: uninstallNodejs"),s("OutboundLink")],1),s("br"),e._v(" "),s("a",{attrs:{href:"https://gist.github.com/tonymtz/d75101d9bdf764c890ef",target:"_blank",rel:"noopener noreferrer"}},[e._v("gist: Uninstall nodejs from OSX Yosemite"),s("OutboundLink")],1),s("br"),e._v(" "),s("a",{attrs:{href:"https://webpack.js.org/",target:"_blank",rel:"noopener noreferrer"}},[e._v("webpack"),s("OutboundLink")],1),s("br"),e._v(" "),s("a",{attrs:{href:"https://docs.npmjs.com/cli/run-script",target:"_blank",rel:"noopener noreferrer"}},[e._v("npm-run-script"),s("OutboundLink")],1)])])}),[],!1,null,null,null);s.default=t.exports}}]);